<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Timer & Stopwatch App</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

    <style>
        :root {
            --bg-color: #000000;
            --text-color: #ffffff;
            --accent-color: #333333;
            --danger-color: #ff3333;
            --font-main: 'Roboto', sans-serif;
            --panel-bg: rgba(255, 255, 255, 0.15);
            --dropdown-bg: #1a1a1a;
        }

        body.light-mode {
            --bg-color: #ffffff;
            --text-color: #000000;
            --accent-color: #e0e0e0;
            --panel-bg: rgba(0, 0, 0, 0.05);
            --dropdown-bg: #f5f5f5;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: var(--font-main);
            height: 100dvh;
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s, color 0.3s;
            overflow: hidden;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            z-index: 10;
            height: 70px;
            flex-shrink: 0;
        }

        .icon-btn {
            background: none; border: none; color: var(--text-color);
            cursor: pointer; padding: 10px; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
        }
        .icon-btn:hover { background-color: var(--panel-bg); }
        .material-icons-outlined { font-size: 28px; }

        /* --- Logo Overlay w Fullscreen --- */
        #fs-logo-container {
            display: none;
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 5;
            transition: opacity 0.5s;
        }
        #fs-logo-container img {
            max-height: 80px;
            max-width: 200px;
            object-fit: contain;
        }
        body.fullscreen-active #fs-logo-container.visible { display: block; }

        /* --- Footer Styles --- */
        footer {
            height: 60px;
            border-top: 1px solid var(--accent-color);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            background: var(--bg-color);
            z-index: 10;
        }

        .logo-selector {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .logo-option {
            cursor: pointer;
            opacity: 0.4;
            transition: opacity 0.2s, transform 0.2s;
            font-weight: 700;
            font-size: 0.8rem;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid transparent;
        }
        .logo-option:hover { opacity: 0.8; }
        .logo-option.active { 
            opacity: 1; 
            border-color: var(--text-color);
            transform: scale(1.1);
        }

        main {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%;
            position: relative;
        }

        .mode-switch { display: flex; gap: 30px; margin-bottom: 5vh; }
        .mode-btn {
            background: none; border: none; color: var(--text-color); opacity: 0.4;
            font-size: 1.1rem; cursor: pointer; text-transform: uppercase;
            letter-spacing: 2px; padding-bottom: 10px; border-bottom: 2px solid transparent;
        }
        .mode-btn.active { opacity: 1; border-bottom: 2px solid var(--text-color); }

        .time-display { font-size: 18vw; font-weight: 300; display: flex; align-items: center; gap: 2vw; margin-bottom: 2vh; }
        .time-input { background: transparent; border: none; color: inherit; font-family: inherit; font-size: inherit; width: 2ch; text-align: center; }
        .time-input:focus { outline: none; background-color: var(--panel-bg); border-radius: 12px; }
        .separator { opacity: 0.5; transform: translateY(-8%); }
        .danger-zone input, .danger-zone span { color: var(--danger-color); }

        .controls { display: flex; gap: 25px; margin-top: 4vh; }
        .btn-round {
            width: 70px; height: 70px; border-radius: 50%; border: 2px solid var(--text-color);
            background: transparent; color: var(--text-color); font-size: 2rem; cursor: pointer;
            display: flex; justify-content: center; align-items: center;
        }
        .btn-pill { padding: 12px 20px; border-radius: 30px; border: 1px solid var(--text-color); background: transparent; color: var(--text-color); cursor: pointer; }

        .alarm-menu {
            position: absolute; top: 60px; left: 10px; background-color: var(--dropdown-bg);
            border: 1px solid var(--accent-color); border-radius: 12px; padding: 10px;
            display: none; flex-direction: column; min-width: 260px; z-index: 200;
        }
        .alarm-menu.show { display: flex; }
        .alarm-option { display: flex; justify-content: space-between; padding: 12px; border-radius: 8px; cursor: pointer; }
        .alarm-option.selected { background-color: var(--panel-bg); font-weight: bold; }

        .fs-controls { display: none; position: absolute; top: 20px; right: 20px; gap: 15px; z-index: 999; }

        body.fullscreen-active header, body.fullscreen-active footer, body.fullscreen-active .mode-switch,
        body.fullscreen-active .quick-add-container, body.fullscreen-active .controls { display: none !important; }
        body.fullscreen-active .fs-controls { display: flex; }
        body.fullscreen-active .time-display { font-size: 28vw; pointer-events: auto; }
        
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <header>
        <div class="header-left">
            <button class="icon-btn" id="btn-alarm"><span class="material-icons-outlined">notifications</span></button>
            <div class="alarm-menu" id="alarm-menu">
                <div class="alarm-option" data-sound="gong" onclick="app.selectSound('gong')"><span>Gong Tybetański</span></div>
                <div class="alarm-option" data-sound="bell" onclick="app.selectSound('bell')"><span>Szklany Dzwonek</span></div>
                <div class="alarm-option" data-sound="chime" onclick="app.selectSound('chime')"><span>Spokojny Chime</span></div>
            </div>
            <button class="icon-btn" onclick="app.toggleMute()"><span class="material-icons-outlined" id="mute-icon">volume_up</span></button>
        </div>
        <div class="header-right">
            <button class="icon-btn" onclick="app.toggleTheme()"><span class="material-icons-outlined" id="theme-icon">light_mode</span></button>
            <button class="icon-btn" onclick="app.toggleFullscreen()"><span class="material-icons-outlined">fullscreen</span></button>
        </div>
    </header>

    <div class="fs-controls">
        <button class="icon-btn" onclick="app.toggleMute()"><span class="material-icons-outlined" id="mute-icon-fs">volume_up</span></button>
        <button class="icon-btn" onclick="app.toggleFullscreen()"><span class="material-icons-outlined">fullscreen_exit</span></button>
    </div>

    <main>
        <div id="fs-logo-container">
            <img id="fs-logo-img" src="" alt="Logo">
        </div>

        <div class="mode-switch">
            <button class="mode-btn active" id="tab-timer" onclick="app.setMode('timer')">Minutnik</button>
            <button class="mode-btn" id="tab-stopwatch" onclick="app.setMode('stopwatch')">Stoper</button>
        </div>

        <div id="view-timer">
            <div class="time-display" id="timer-display">
                <input type="number" id="hh" class="time-input" value="00"><span>:</span>
                <input type="number" id="mm" class="time-input" value="10"><span>:</span>
                <input type="number" id="ss" class="time-input" value="00">
            </div>
            <div class="controls">
                <button class="btn-round" id="t-start" onclick="app.toggleTimer()"><span class="material-icons-outlined">play_arrow</span></button>
                <button class="btn-round" onclick="app.resetTimer()"><span class="material-icons-outlined">refresh</span></button>
            </div>
        </div>

        <div id="view-stopwatch" class="hidden">
            <div class="time-display" id="sw-display">00 : 00 : 00</div>
            <div class="controls">
                <button class="btn-round" id="sw-start" onclick="app.toggleStopwatch()"><span class="material-icons-outlined">play_arrow</span></button>
                <button class="btn-round" onclick="app.resetStopwatch()"><span class="material-icons-outlined">refresh</span></button>
            </div>
        </div>
    </main>

    <footer>
        <div class="logo-selector">
            <span style="font-size: 0.7rem; opacity: 0.5; text-transform: uppercase;">Logo w Fullscreen:</span>
            <div class="logo-option active" data-logo="none" onclick="app.selectLogo('none')">
                <span class="material-icons-outlined" style="font-size: 1.2rem;">visibility_off</span>
            </div>
            <div class="logo-option" data-logo="BNI" onclick="app.selectLogo('BNI')">BNI+</div>
            <div class="logo-option" data-logo="CC" onclick="app.selectLogo('CC')">CC</div>
            <div class="logo-option" data-logo="TC" onclick="app.selectLogo('TC')">TC</div>
        </div>
    </footer>

    <script>
        // --- AUDIO & STATE ---
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function createSoftTone(f, d, a=0.05, dec=1.5, v=0.3) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const t = audioCtx.currentTime, osc = audioCtx.createOscillator(), g = audioCtx.createGain();
            osc.type = 'sine'; osc.frequency.setValueAtTime(f, t);
            g.gain.setValueAtTime(0, t); g.gain.linearRampToValueAtTime(v, t+a); g.gain.exponentialRampToValueAtTime(0.001, t+d);
            osc.connect(g); g.connect(audioCtx.destination); osc.start(t); osc.stop(t+d);
        }
        const SoundGen = {
            gong() { createSoftTone(220, 3.5, 0.1, 3.0, 0.4); },
            bell() { createSoftTone(1100, 2.0, 0.01, 1.5, 0.25); },
            chime() { createSoftTone(659, 1.5, 0.02, 1.2, 0.25); },
            play(type) { this[type] ? this[type]() : null; }
        };

        const STATE = {
            mode: 'timer', theme: 'dark', sound: 'gong', muted: false, selectedLogo: 'none',
            timer: { running: false, interval: null, remaining: 600 },
            stopwatch: { running: false, interval: null, startT: 0, elapsed: 0 }
        };

        const app = {
            init() {
                document.getElementById('btn-alarm').onclick = (e) => { e.stopPropagation(); document.getElementById('alarm-menu').classList.toggle('show'); };
                document.onclick = () => document.getElementById('alarm-menu').classList.remove('show');
                this.updateLogoVisibility();
            },

            // --- LOGO LOGIC ---
            selectLogo(logoId) {
                STATE.selectedLogo = logoId;
                document.querySelectorAll('.logo-option').forEach(el => el.classList.remove('active'));
                document.querySelector(`.logo-option[data-logo="${logoId}"]`).classList.add('active');
                this.updateLogoVisibility();
            },

            updateLogoVisibility() {
                const container = document.getElementById('fs-logo-container');
                const img = document.getElementById('fs-logo-img');
                
                if (STATE.selectedLogo === 'none') {
                    container.classList.remove('visible');
                } else {
                    // Logika nazw plików: TC.svg dla jasnego, TC-WHITE.svg dla ciemnego
                    const suffix = (STATE.theme === 'dark') ? '-WHITE' : '';
                    img.src = `${STATE.selectedLogo}${suffix}.svg`;
                    container.classList.add('visible');
                }
            },

            toggleTheme() {
                STATE.theme = STATE.theme === 'dark' ? 'light' : 'dark';
                document.body.classList.toggle('light-mode', STATE.theme === 'light');
                document.getElementById('theme-icon').innerText = STATE.theme === 'light' ? 'dark_mode' : 'light_mode';
                this.updateLogoVisibility(); // Odśwież logo przy zmianie motywu
            },

            toggleFullscreen() {
                const doc = document.documentElement;
                if (!(document.fullscreenElement || document.webkitFullscreenElement)) {
                    if (doc.requestFullscreen) doc.requestFullscreen();
                    else if (doc.webkitRequestFullscreen) doc.webkitRequestFullscreen();
                    document.body.classList.add('fullscreen-active');
                } else {
                    if (document.exitFullscreen) document.exitFullscreen();
                    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
                    document.body.classList.remove('fullscreen-active');
                }
            },

            // --- TIMER & STOPWATCH (Uproszczone dla czytelności) ---
            setMode(m) {
                STATE.mode = m;
                document.getElementById('view-timer').classList.toggle('hidden', m !== 'timer');
                document.getElementById('view-stopwatch').classList.toggle('hidden', m !== 'stopwatch');
                document.getElementById('tab-timer').classList.toggle('active', m === 'timer');
                document.getElementById('tab-stopwatch').classList.toggle('active', m === 'stopwatch');
            },
            toggleMute() {
                STATE.muted = !STATE.muted;
                const icon = STATE.muted ? 'volume_off' : 'volume_up';
                document.getElementById('mute-icon').innerText = icon;
                document.getElementById('mute-icon-fs').innerText = icon;
            },
            selectSound(s) { STATE.sound = s; },
            toggleTimer() { /* Twoja istniejąca logika */ },
            resetTimer() { /* Twoja istniejąca logika */ },
            toggleStopwatch() { /* Twoja istniejąca logika */ },
            resetStopwatch() { /* Twoja istniejąca logika */ }
        };

        // Nasłuchiwanie wyjścia z FS klawiszem ESC
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) document.body.classList.remove('fullscreen-active');
        });
        document.addEventListener('webkitfullscreenchange', () => {
            if (!document.webkitFullscreenElement) document.body.classList.remove('fullscreen-active');
        });

        app.init();
    </script>
</body>
</html>
